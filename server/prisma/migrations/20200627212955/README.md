# Migration `20200627212955`

This migration has been generated by gyash24x7 at 6/27/2020, 9:29:55 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "GameActivityType" AS ENUM ('PLAYER_JOINED', 'TEAMS_CREATED', 'GAME_STARTED');

CREATE TYPE "GameStatus" AS ENUM ('NOT_STARTED', 'TEAMS_CREATED', 'STARTED', 'COMPLETED');

CREATE TABLE "public"."User" (
"email" text  NOT NULL ,"id" text  NOT NULL ,"name" text  NOT NULL ,"password" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Game" (
"code" text  NOT NULL ,"id" text  NOT NULL ,"playerCount" integer  NOT NULL DEFAULT 6,"status" "GameStatus" NOT NULL DEFAULT E'NOT_STARTED',
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Team" (
"id" text  NOT NULL ,"name" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."GameActivity" (
"description" text  NOT NULL ,"gameId" text  NOT NULL ,"id" text  NOT NULL ,"type" "GameActivityType" NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."_GameToUser" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_TeamToUser" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE TABLE "public"."_GameToTeam" (
"A" text  NOT NULL ,"B" text  NOT NULL )

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "_GameToUser_AB_unique" ON "public"."_GameToUser"("A","B")

CREATE  INDEX "_GameToUser_B_index" ON "public"."_GameToUser"("B")

CREATE UNIQUE INDEX "_TeamToUser_AB_unique" ON "public"."_TeamToUser"("A","B")

CREATE  INDEX "_TeamToUser_B_index" ON "public"."_TeamToUser"("B")

CREATE UNIQUE INDEX "_GameToTeam_AB_unique" ON "public"."_GameToTeam"("A","B")

CREATE  INDEX "_GameToTeam_B_index" ON "public"."_GameToTeam"("B")

ALTER TABLE "public"."GameActivity" ADD FOREIGN KEY ("gameId")REFERENCES "public"."Game"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_GameToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Game"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_GameToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_TeamToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Team"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_TeamToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_GameToTeam" ADD FOREIGN KEY ("A")REFERENCES "public"."Game"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."_GameToTeam" ADD FOREIGN KEY ("B")REFERENCES "public"."Team"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200627212955
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,58 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id       String @id @default(cuid())
+  name     String
+  email    String @unique
+  password String
+  games    Game[] @relation(references: [id])
+  teams    Team[] @relation(references: [id])
+}
+
+model Game {
+  id          String         @id @default(cuid())
+  code        String
+  players     User[]         @relation(references: [id])
+  status      GameStatus     @default(NOT_STARTED)
+  playerCount Int            @default(6)
+  teams       Team[]         @relation(references: [id])
+  activity    GameActivity[]
+}
+
+model Team {
+  id      String @id @default(cuid())
+  name    String
+  members User[] @relation(references: [id])
+  games   Game[] @relation(references: [id])
+}
+
+model GameActivity {
+  id          String           @id @default(cuid())
+  description String
+  type        GameActivityType
+  game        Game             @relation(fields: [gameId], references: [id])
+  gameId      String
+}
+
+enum GameActivityType {
+  PLAYER_JOINED
+  TEAMS_CREATED
+  GAME_STARTED
+}
+
+enum GameStatus {
+  NOT_STARTED
+  TEAMS_CREATED
+  STARTED
+  COMPLETED
+}
```


