# Migration `20200628135222`

This migration has been generated by gyash24x7 at 6/28/2020, 1:52:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Player" (
"gameId" text  NOT NULL ,"hand" text []  ,"id" text  NOT NULL ,"team" text  NOT NULL ,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Game" ADD COLUMN "teams" text []  ;

ALTER TABLE "public"."_GameToTeam" DROP CONSTRAINT IF EXiSTS "_GameToTeam_A_fkey";

ALTER TABLE "public"."_GameToTeam" DROP CONSTRAINT IF EXiSTS "_GameToTeam_B_fkey";

ALTER TABLE "public"."_GameToUser" DROP CONSTRAINT IF EXiSTS "_GameToUser_A_fkey";

ALTER TABLE "public"."_GameToUser" DROP CONSTRAINT IF EXiSTS "_GameToUser_B_fkey";

ALTER TABLE "public"."_TeamToUser" DROP CONSTRAINT IF EXiSTS "_TeamToUser_A_fkey";

ALTER TABLE "public"."_TeamToUser" DROP CONSTRAINT IF EXiSTS "_TeamToUser_B_fkey";

ALTER TABLE "public"."Player" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Player" ADD FOREIGN KEY ("gameId")REFERENCES "public"."Game"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."Team";

DROP TABLE "public"."_GameToTeam";

DROP TABLE "public"."_GameToUser";

DROP TABLE "public"."_TeamToUser";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200628132924..20200628135222
--- datamodel.dml
+++ datamodel.dml
@@ -1,41 +1,43 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id       String @id @default(cuid())
+  id       String   @id @default(cuid())
   name     String
-  email    String @unique
+  email    String   @unique
   password String
-  salt     String @unique
+  salt     String   @unique
   avatar   String
-  games    Game[] @relation(references: [id])
-  teams    Team[] @relation(references: [id])
+  players  Player[]
 }
+model Player {
+  id     String   @id @default(cuid())
+  user   User     @relation(fields: [userId], references: [id])
+  userId String
+  team   String
+  gameId String
+  game   Game     @relation(fields: [gameId], references: [id])
+  hand   String[]
+}
+
 model Game {
   id          String         @id @default(cuid())
   code        String         @unique
-  players     User[]         @relation(references: [id])
+  players     Player[]
   status      GameStatus     @default(NOT_STARTED)
   playerCount Int            @default(6)
-  teams       Team[]         @relation(references: [id])
+  teams       String[]
   activity    GameActivity[]
 }
-model Team {
-  id      String @id @default(cuid())
-  name    String
-  members User[] @relation(references: [id])
-  games   Game[] @relation(references: [id])
-}
-
 model GameActivity {
   id          String           @id @default(cuid())
   description String
   kind        GameActivityKind
```


